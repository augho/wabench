Native = ${Benchmark}
WASM = ${Benchmark}.wasm

SRC = $(wildcard ${SRCDIR}/*.${SRCSUFFIX})
OBJ = $(SRC:.${SRCSUFFIX}=.o)


ifeq (${SRCSUFFIX}, $(filter ${SRCSUFFIX}, cc cpp))
    CC = ${CXX}
endif

OPT=-O2
WASMCC_ARGS=
CC_ARGS=

all: ${Native} ${WASM}

%.o: %.${SRCSUFFIX}
	${CC} ${CFLAGS} ${OPT} ${CINCLUDE} ${CC_ARGS} -c $< -o $@

${Native}: ${OBJ}
	${CC} ${CFLAGS} ${OPT} $^ ${LDFLAGS} -o $@

${WASM}: ${SRC}
	${CC} ${CFLAGS} ${OPT} ${CINCLUDE} ${WASMCC_ARGS} $^ -o $@

clean:
	@echo "Cleaning up..."
	rm -rf ${OBJ} ${Native} ${WASM} ${TEMPFILE} *.cwasm output_* *.wasmu *.in

build-native: ${Native}

build-wasm: ${WASM}